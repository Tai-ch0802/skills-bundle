# 架構範例

> 依專案類型的真實架構決策。

---

## 範例 1：MVP 電商（單人開發）

```yaml
需求：
  - 初期 <1000 使用者
  - 單人開發
  - 快速上市（8 週）
  - 預算有限

架構決策：
  應用結構：單體（單人開發較簡單）
  框架：Next.js（全端、快速）
  資料層：Prisma 直接使用（不過度抽象）
  驗證：JWT（比 OAuth 簡單）
  支付：Stripe（托管解決方案）
  資料庫：PostgreSQL（訂單需要 ACID）

接受的權衡：
  - 單體 → 無法獨立擴展（團隊規模不足以證明需要）
  - 無 Repository → 較難測試（簡單 CRUD 不需要）
  - JWT → 初期無社交登入（之後可加）

未來遷移路徑：
  - 使用者 > 10K → 抽取支付服務
  - 團隊 > 3 → 加入 Repository 模式
  - 需要社交登入 → 加入 OAuth
```

---

## 範例 2：SaaS 產品（5-10 名開發者）

```yaml
需求：
  - 1K-100K 使用者
  - 5-10 名開發者
  - 長期（12+ 個月）
  - 多個領域（計費、使用者、核心）

架構決策：
  應用結構：模組化單體（團隊規模最佳）
  框架：NestJS（設計上就是模組化的）
  資料層：Repository 模式（測試、彈性）
  領域模型：部分 DDD（豐富實體）
  驗證：OAuth + JWT
  快取：Redis
  資料庫：PostgreSQL

接受的權衡：
  - 模組化單體 → 部分模組耦合（微服務不合理）
  - 部分 DDD → 無完整聚合根（無領域專家）
  - RabbitMQ 之後再加 → 初期同步（在證明需要時再加）

遷移路徑：
  - 團隊 > 10 → 考慮微服務
  - 領域衝突 → 抽取有界上下文
  - 讀取效能問題 → 加入 CQRS
```

---

## 範例 3：企業級（100K+ 使用者）

```yaml
需求：
  - 100K+ 使用者
  - 10+ 名開發者
  - 多個業務領域
  - 不同的擴展需求
  - 24/7 可用性

架構決策：
  應用結構：微服務（獨立擴展）
  API 閘道：Kong/AWS API GW
  領域模型：完整 DDD
  一致性：事件驅動（最終一致性可接受）
  訊息匯流排：Kafka
  驗證：OAuth + SAML（企業 SSO）
  資料庫：混合持久（每個工作選擇合適的工具）
  CQRS：選定的服務

營運需求：
  - 服務網格（Istio/Linkerd）
  - 分散式追蹤（Jaeger/Tempo）
  - 集中式日誌（ELK/Loki）
  - 斷路器（Resilience4j）
  - Kubernetes/Helm
```
