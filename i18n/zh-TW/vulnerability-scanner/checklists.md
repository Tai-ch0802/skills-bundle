# 安全檢查清單

> 安全稽核的快速參考檢查清單。搭配 vulnerability-scanner 原則使用。

---

## OWASP Top 10 稽核檢查清單

### A01：破壞的存取控制
- [ ] 所有受保護路由都有授權
- [ ] 預設拒絕
- [ ] 已實作速率限制
- [ ] CORS 正確配置

### A02：加密失敗
- [ ] 密碼已雜湊（bcrypt/argon2，成本 12+）
- [ ] 靜態敏感資料已加密
- [ ] 所有連線使用 TLS 1.2+
- [ ] 程式碼/日誌中無密鑰

### A03：注入
- [ ] 參數化查詢
- [ ] 所有使用者資料都有輸入驗證
- [ ] XSS 的輸出編碼
- [ ] 無 eval() 或動態程式碼執行

### A04：不安全的設計
- [ ] 已完成威脅建模
- [ ] 已定義安全需求
- [ ] 已驗證業務邏輯

### A05：安全設定錯誤
- [ ] 已停用不必要的功能
- [ ] 已清理錯誤訊息
- [ ] 已配置安全標頭
- [ ] 已變更預設憑證

### A06：有弱點的元件
- [ ] 依賴已更新
- [ ] 無已知弱點
- [ ] 已移除未使用的依賴

### A07：驗證失敗
- [ ] 可用 MFA
- [ ] 登出時 Session 失效
- [ ] 已實作 Session 逾時
- [ ] 暴力破解防護

### A08：完整性失敗
- [ ] 已驗證依賴完整性
- [ ] CI/CD 管線已保護
- [ ] 更新機制已保護

### A09：日誌失敗
- [ ] 已記錄安全事件
- [ ] 日誌已保護
- [ ] 日誌中無敏感資料
- [ ] 已配置警報

### A10：SSRF
- [ ] 已實作 URL 驗證
- [ ] 外部呼叫的允許清單
- [ ] 網路分段

---

## 驗證檢查清單

- [ ] 強密碼政策
- [ ] 帳戶鎖定
- [ ] 安全密碼重設
- [ ] Session 管理
- [ ] Token 過期
- [ ] 登出失效

---

## API 安全檢查清單

- [ ] 需要驗證
- [ ] 每個端點的授權
- [ ] 輸入驗證
- [ ] 速率限制
- [ ] 輸出清理
- [ ] 錯誤處理

---

## 資料保護檢查清單

- [ ] 靜態加密
- [ ] 傳輸加密
- [ ] 金鑰管理
- [ ] 資料最小化
- [ ] 安全刪除

---

## 安全標頭

| 標頭 | 用途 |
|------|------|
| **Content-Security-Policy** | XSS 防護 |
| **X-Content-Type-Options** | MIME 嗅探 |
| **X-Frame-Options** | 點擊劫持 |
| **Strict-Transport-Security** | 強制 HTTPS |
| **Referrer-Policy** | Referrer 控制 |

---

## 快速稽核指令

| 檢查 | 要尋找什麼 |
|------|------------|
| 程式碼中的密鑰 | password、api_key、secret |
| 危險模式 | eval、innerHTML、SQL 拼接 |
| 依賴問題 | npm audit、snyk |

---

> **使用方式：** 將相關檢查清單複製到你的 PLAN.md 或安全報告中。
