# 索引原則

> 何時以及如何有效建立索引。

## 何時建立索引

```
要索引這些：
├── WHERE 子句中的欄位
├── JOIN 條件中的欄位
├── ORDER BY 中的欄位
├── 外鍵欄位
└── 唯一性約束

不要過度索引：
├── 寫入密集的資料表（插入更慢）
├── 低基數欄位
├── 很少被查詢的欄位
```

## 索引類型選擇

| 類型 | 用途 |
|------|------|
| **B-tree** | 通用、等值與範圍 |
| **Hash** | 僅等值、更快 |
| **GIN** | JSONB、陣列、全文搜尋 |
| **GiST** | 幾何、範圍型別 |
| **HNSW/IVFFlat** | 向量相似度（pgvector）|

## 複合索引原則

```
複合索引的順序很重要：
├── 等值欄位在前
├── 範圍欄位在後
├── 最具選擇性的在前
└── 匹配查詢模式
```
